---
import CoverCardGrid from "../components/CoverCardGrid.astro";
import PageHeader from "../components/PageHeader.astro";
import Tag from "../components/Tag.astro";
import TagCloud from "../components/TagCloud.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import { supabase } from "../lib/supabase";

const { data: covers } = await supabase
  .from("covers")
  .select(
    `
    slug,
    original:original_id(id, name, artists, album_name, album_img),
    cover:cover_id(id, name, artists, album_name, album_img)
  `
  )
  .order("created_at", { ascending: false })
  .range(0, 23); // 24 entries total
---

<BaseLayout
  title="Genderswap.fm"
  description="Some covers deliver the age-old simple pleasures of drag."
>
  <PageHeader
    title="Genderswap.fm"
    description="Some covers deliver the age-old simple pleasures of drag."
  >
    <TagCloud>
      <Tag text="Explore by tag" url="/tagged" />
      <Tag text="Get random cover" url="/random" />
    </TagCloud>
  </PageHeader>
  <CoverCardGrid covers={covers as any} />
</BaseLayout>
